<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
                             "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:a="http://richfaces.org/a4j"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:rich="http://richfaces.org/rich" template="layout/template.xhtml">

	<ui:define name="body">




		<h:messages globalOnly="true" styleClass="message" id="globalMessages" />

		<h:form id="people" styleClass="edit">

			<rich:panel>
				<f:facet name="header">#{peopleHome.managed ? 'Modifica' : 'Aggiungi'} Persona</f:facet>


				<s:decorate id="idpeopleDecoration" template="layout/edit.xhtml">
					<ui:define name="label">Username</ui:define>
					<h:inputText id="idpeople" size="64" maxlength="64" required="true"
						value="#{peopleHome.instance.idpeople}">
					</h:inputText>
				</s:decorate>




				<s:decorate id="nomeDecoration" template="layout/edit.xhtml">
					<ui:define name="label">Nome</ui:define>
					<h:inputText id="nome" size="64" maxlength="64"
						value="#{peopleHome.instance.nome}">
						<a:support event="onblur" reRender="nomeDecoration"
							bypassUpdates="true" ajaxSingle="true" />
					</h:inputText>
				</s:decorate>


				<s:decorate id="cognomeDecoration" template="layout/edit.xhtml">
					<ui:define name="label">Cognome</ui:define>
					<h:inputText id="cognome" size="64" maxlength="64"
						value="#{peopleHome.instance.cognome}" />
				</s:decorate>


				<s:decorate id="passwordDecoration" template="layout/edit.xhtml">
					<ui:define name="label">Password</ui:define>
					<h:inputSecret id="password" redisplay="true"
						value="#{peopleHome.instance.password}" />
					<input type='button'
						onclick="javascript:alert(document.getElementById('people:passwordDecoration:password').value);"
						value='Mostra' />

				</s:decorate>

				<s:decorate id="telefonoDecoration" template="layout/edit.xhtml">
					<ui:define name="label">Telefono</ui:define>
					<h:inputText id="telefono" size="20" maxlength="20"
						value="#{peopleHome.instance.telefono}">
						<a:support event="onblur" reRender="telefonoDecoration"
							bypassUpdates="true" ajaxSingle="true" />
					</h:inputText>
				</s:decorate>


				<s:decorate id="faxDecoration" template="layout/edit.xhtml">
					<ui:define name="label">Fax</ui:define>
					<h:inputText id="fax" size="20" maxlength="20"
						value="#{peopleHome.instance.fax}">
						<a:support event="onblur" reRender="faxDecoration"
							bypassUpdates="true" ajaxSingle="true" />
					</h:inputText>
				</s:decorate>


				<s:decorate id="emailDecoration" template="layout/edit.xhtml">
					<ui:define name="label">Email</ui:define>
					<h:inputText id="email" size="64" maxlength="64"
						value="#{peopleHome.instance.email}" />
				</s:decorate>


				<s:decorate id="profiloProfessionaleDecoration"
					template="layout/edit.xhtml">
					<ui:define name="label">Profilo Professionale</ui:define>
					<h:inputText id="profiloProfessionale" size="64" maxlength="64"
						value="#{peopleHome.instance.profiloProfessionale}" />
				</s:decorate>


				<s:decorate id="descrizioneDecoration" template="layout/edit.xhtml">
					<ui:define name="label">Descrizione</ui:define>
					<h:inputTextarea id="descrizione" cols="64" rows="3"
						value="#{peopleHome.instance.descrizione}" />
				</s:decorate>

				<s:decorate id="telefonoPrivatoDecoration"
					template="layout/edit.xhtml">
					<ui:define name="label">Telefono privato</ui:define>
					<h:inputText id="telefonoPrivato" size="20" maxlength="20"
						value="#{peopleHome.instance.telefonoPrivato}">
						<a:support event="onblur" reRender="telefonoPrivatoDecoration"
							bypassUpdates="true" ajaxSingle="true" />
					</h:inputText>
				</s:decorate>


				<s:decorate id="fax1Decoration" template="layout/edit.xhtml">
					<ui:define name="label">Fax secondario</ui:define>
					<h:inputText id="fax1" size="20" maxlength="20"
						value="#{peopleHome.instance.fax1}">
						<a:support event="onblur" reRender="fax1Decoration"
							bypassUpdates="true" ajaxSingle="true" />
					</h:inputText>
				</s:decorate>


				<s:decorate id="email1Decoration" template="layout/edit.xhtml">
					<ui:define name="label">Email secondaria</ui:define>
					<h:inputText id="email1" size="64" maxlength="64"
						value="#{peopleHome.instance.email1}" />
				</s:decorate>


				<s:decorate id="cellulareDecoration" template="layout/edit.xhtml">
					<ui:define name="label">Cellulare</ui:define>
					<h:inputText id="cellulare" size="20" maxlength="20"
						value="#{peopleHome.instance.cellulare}">
						<a:support event="onblur" reRender="cellulareDecoration"
							bypassUpdates="true" ajaxSingle="true" />
					</h:inputText>
				</s:decorate>


				<s:decorate id="numeroBreveDecoration" template="layout/edit.xhtml">
					<ui:define name="label">Numero breve</ui:define>
					<h:inputText id="numeroBreve" size="20" maxlength="20"
						value="#{peopleHome.instance.numeroBreve}">
						<a:support event="onblur" reRender="numeroBreveDecoration"
							bypassUpdates="true" ajaxSingle="true" />
					</h:inputText>
				</s:decorate>


				<s:decorate id="visibleDecoration" template="layout/edit.xhtml">
					<ui:define name="label">Visible</ui:define>
					<h:selectBooleanCheckbox id="visible"
						value="#{peopleHome.instance.visible}" />
				</s:decorate>

				<s:decorate id="pecDecoration" template="layout/edit.xhtml">
					<ui:define name="label">PEC</ui:define>
					<h:inputText id="pec" size="64" maxlength="64"
						value="#{peopleHome.instance.PEC}">
					</h:inputText>
				</s:decorate>


				<s:decorate id="sedeDecoration" template="layout/edit.xhtml">
					<ui:define name="label">Sede</ui:define>
					<h:selectOneMenu id="sede" value="#{peopleHome.instance.sede}">
						<s:selectItems value="#{sedeList.resultList}"
							noSelectionLabel="---" var="sede" label="#{sede}" />
						<s:convertEntity></s:convertEntity>
					</h:selectOneMenu>
				</s:decorate>

				<s:decorate id="orarioDecoration" template="layout/edit.xhtml">
					<ui:define name="label">Orario</ui:define>
					<h:selectOneMenu id="orario" value="#{peopleHome.instance.orario}">
						<s:selectItems value="#{orarioList.resultList}"
							noSelectionLabel="---" var="orario" label="#{orario}" />
						<s:convertEntity></s:convertEntity>


					</h:selectOneMenu>
				</s:decorate>

				<s:decorate id="enteDecoration" template="layout/edit.xhtml">
					<ui:define name="label">Ente</ui:define>
					<rich:pickList value="#{peopleHome.instance.entesAsList}"
						sourceListWidth="350px" targetListWidth="350px"
						showButtonsLabel="false" reRender="ruoliTable">
						<s:selectItems value="#{enteList.allEntes}" var="ente"
							label="#{ente}" />

						<s:convertEntity />
						<a:support event="onlistchanged" reRender="newRole" />
					</rich:pickList>

				</s:decorate>


				<s:decorate id="areaDecoration" template="layout/edit.xhtml">
					<ui:define name="label">Settore</ui:define>
					<rich:pickList value="#{peopleHome.instance.areasAsList}"
						sourceListWidth="350px" targetListWidth="350px"
						showButtonsLabel="false" reRender="ruoliTable">
						<s:selectItems value="#{areaList.allSettores}" var="area"
							label="#{area}" />
						<s:convertEntity />
						<a:support event="onlistchanged" reRender="newRole" />
					</rich:pickList>
				</s:decorate>

				<s:decorate id="ufficioDecoration" template="layout/edit.xhtml">
					<ui:define name="label">Ufficio</ui:define>
					<rich:pickList value="#{peopleHome.instance.ufficiosAsList}"
						sourceListWidth="350px" targetListWidth="350px"
						showButtonsLabel="false" reRender="ruoliTable">
						<s:selectItems value="#{ufficioList.allUfficios}" var="ufficio"
							label="#{ufficio}" />
						<s:convertEntity />
						<a:support event="onlistchanged" reRender="newRole" />
					</rich:pickList>
				</s:decorate>

				<s:div style="clear:both" />


				<s:decorate id="RuoliTableDecoration">

					<rich:dataTable style="margin-bottom: 20px;" id="ruoliTable"
						onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
						onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'"
						cellpadding="0" cellspacing="0" width="700" border="0" var="ruolo"
						value="#{peopleHome.getRoles()}">
						<f:facet name="header">
							<rich:columnGroup>

								<rich:column>
									<h:outputText value="Ruolo" />
								</rich:column>
								<rich:column>
									<h:outputText value="Ente" />
								</rich:column>
								<rich:column>
									<h:outputText value="Settore" />
								</rich:column>
								<rich:column>
									<h:outputText value="Ufficio" />
								</rich:column>
								<rich:column>
									<h:outputText value="Azioni" />
								</rich:column>
							</rich:columnGroup>
						</f:facet>
						<rich:column>
							<h:outputText value="#{ruolo.roletype.role}" />
						</rich:column>
						<rich:column>
							<h:outputText value="#{ruolo.ente}" />
						</rich:column>
						<rich:column>
							<h:outputText value="#{ruolo.area}" />
						</rich:column>
						<rich:column>
							<h:outputText value="#{ruolo.ufficio}" />
						</rich:column>
						<rich:column>
							<a:commandLink value="Elimina" reRender="RuoliTableDecoration"
								limitToList="true" ajaxSingle="true"
								action="#{peopleHome.removeRole(ruolo)}">
							</a:commandLink>
						</rich:column>

						<f:facet name="footer">

							<rich:dropDownMenu id="newRole">
								<f:facet name="label">
									<h:panelGroup>
										<h:outputText value="Nuovo ruolo +" />
									</h:panelGroup>
								</f:facet>
								<c:forEach items="#{peopleHome.instance.entesAsList}" var="ente">
									<rich:menuGroup value="#{ente}">
										<c:forEach items="#{roletypeList.resultList}" var="roleType">
											<rich:menuItem submitMode="ajax" limitToList="true"
												ajaxSingle="true"
												action="#{peopleHome.addRole(ente,roleType)}"
												reRender="RuoliTableDecoration" value="#{roleType.role}" />
										</c:forEach>
									</rich:menuGroup>
								</c:forEach>
								<rich:menuSeparator />
								<c:forEach items="#{peopleHome.instance.areasAsList}" var="area">
									<rich:menuGroup value="#{area}">
										<c:forEach items="#{roletypeList.resultList}" var="roleType">
											<rich:menuItem submitMode="ajax" limitToList="true"
												ajaxSingle="true"
												action="#{peopleHome.addRole(area,roleType)}"
												reRender="RuoliTableDecoration" value="#{roleType.role}" />
										</c:forEach>
									</rich:menuGroup>
								</c:forEach>
								<rich:menuSeparator />
								<c:forEach items="#{peopleHome.instance.ufficiosAsList}"
									var="ufficio">
									<rich:menuGroup value="#{ufficio}">
										<c:forEach items="#{roletypeList.resultList}" var="roleType">
											<rich:menuItem submitMode="ajax" limitToList="true"
												ajaxSingle="true"
												action="#{peopleHome.addRole(ufficio,roleType)}"
												reRender="RuoliTableDecoration" value="#{roleType.role}" />
										</c:forEach>
									</rich:menuGroup>
								</c:forEach>
							</rich:dropDownMenu>

						</f:facet>
					</rich:dataTable>
				</s:decorate>


				<div style="clear: both"><span class="required">*</span> Campi
				richiesti</div>

			</rich:panel>

			<div class="actionButtons"><h:commandButton id="save"
				value="Salva" action="#{peopleHome.persist}"
				disabled="#{!peopleHome.wired}" rendered="#{!peopleHome.managed}" />

			<h:commandButton id="update" value="Salva"
				action="#{peopleHome.update}" rendered="#{peopleHome.managed}" /> <h:commandButton
				id="delete" value="Elimina" action="#{peopleHome.remove}"
				immediate="true" rendered="#{peopleHome.managed}" /> <s:button
				id="done" value="Annulla" propagation="end" view="/People.xhtml"
				rendered="#{peopleHome.managed}" /> <s:button id="cancel"
				value="Annulla" propagation="end"
				view="/#{empty peopleFrom ? 'PeopleList' : peopleFrom}.xhtml"
				rendered="#{!peopleHome.managed}" /></div>


			<!--<rich:tabPanel switchType="ajax">-->
			<!--    -->
			<!--    <rich:tab label="sede">-->
			<!--    <div class="association" id="sedeParent">-->
			<!--    -->
			<!--        <h:outputText value="There is no sede associated with this people." -->
			<!--                   rendered="#{peopleHome.instance.sede == null}"/>-->
			<!--        -->
			<!--        <rich:dataTable var="sede" -->
			<!--                   value="#{peopleHome.instance.sede}" -->
			<!--                rendered="#{peopleHome.instance.sede != null}"-->
			<!--              rowClasses="rvgRowOne,rvgRowTwo"-->
			<!--                      id="sedeTable">-->
			<!--            <h:column>-->
			<!--                <f:facet name="header">idsede</f:facet>-->
			<!--                #{sede.idsede}-->
			<!--            </h:column>-->
			<!--            <h:column>-->
			<!--                <f:facet name="header">descrizione</f:facet>-->
			<!--                #{sede.descrizione}-->
			<!--            </h:column>-->
			<!--            <h:column>-->
			<!--                <f:facet name="header">action</f:facet>-->
			<!--                <s:link view="/Sede.xhtml" -->
			<!--                         id="viewsede" -->
			<!--                      value="View" -->
			<!--                propagation="none">-->
			<!--                    <f:param name="sedeIdsede" -->
			<!--                           value="#{sede.idsede}"/>-->
			<!--                </s:link>-->
			<!--            </h:column>-->
			<!--        </rich:dataTable>-->
			<!---->
			<!--        <div class="actionButtons">-->
			<!--            <s:button value="Select sede"-->
			<!--                       view="/SedeList.xhtml">-->
			<!--                <f:param name="from" value="PeopleEdit"/>-->
			<!--            </s:button>-->
			<!--        </div>-->
			<!--        -->
			<!--    </div>-->
			<!--    </rich:tab>-->
			<!--    -->
			<!--    <rich:tab label="orario">-->
			<!--    <div class="association" id="orarioParent">-->
			<!--    -->
			<!--        <h:outputText value="There is no orario associated with this people." -->
			<!--                   rendered="#{peopleHome.instance.orario == null}"/>-->
			<!--        -->
			<!--        <rich:dataTable var="orario" -->
			<!--                   value="#{peopleHome.instance.orario}" -->
			<!--                rendered="#{peopleHome.instance.orario != null}"-->
			<!--              rowClasses="rvgRowOne,rvgRowTwo"-->
			<!--                      id="orarioTable">-->
			<!--            <h:column>-->
			<!--                <f:facet name="header">idorario</f:facet>-->
			<!--                #{orario.idorario}-->
			<!--            </h:column>-->
			<!--            <h:column>-->
			<!--                <f:facet name="header">descrizione</f:facet>-->
			<!--                #{orario.descrizione}-->
			<!--            </h:column>-->
			<!--            <h:column>-->
			<!--                <f:facet name="header">action</f:facet>-->
			<!--                <s:link view="/Orario.xhtml" -->
			<!--                         id="vieworario" -->
			<!--                      value="View" -->
			<!--                propagation="none">-->
			<!--                    <f:param name="orarioIdorario" -->
			<!--                           value="#{orario.idorario}"/>-->
			<!--                </s:link>-->
			<!--            </h:column>-->
			<!--        </rich:dataTable>-->
			<!---->
			<!--        <div class="actionButtons">-->
			<!--            <s:button value="Select orario"-->
			<!--                       view="/OrarioList.xhtml">-->
			<!--                <f:param name="from" value="PeopleEdit"/>-->
			<!--            </s:button>-->
			<!--        </div>-->
			<!--        -->
			<!--    </div>-->
			<!--    </rich:tab>-->
			<!--</rich:tabPanel>-->




		</h:form>
	</ui:define>

</ui:composition>
